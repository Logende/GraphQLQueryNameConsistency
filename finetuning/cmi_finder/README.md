Copied and adapted from https://github.com/sola-st/CMI-Finder/